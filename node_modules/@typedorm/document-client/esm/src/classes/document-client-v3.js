import { TransactionCanceledException, } from '@aws-sdk/client-dynamodb';
import { BatchGetCommand, BatchWriteCommand, DeleteCommand, DynamoDBDocumentClient, GetCommand, PutCommand, QueryCommand, ScanCommand, TransactGetCommand, TransactWriteCommand, UpdateCommand, } from '@aws-sdk/lib-dynamodb';
import { TransactionCancelledException } from '../exceptions';
import { DocumentClient } from './base-document-client';
export class DocumentClientV3 extends DocumentClient {
    documentClient;
    version = 3;
    constructor(dynamoDBClient) {
        super();
        const marshallOptions = {
            // Whether to automatically convert empty strings, blobs, and sets to `null`.
            convertEmptyValues: false,
            // Whether to remove undefined values while marshalling.
            removeUndefinedValues: false,
            // Whether to convert typeof object to map attribute.
            convertClassInstanceToMap: false, // false, by default.
        };
        const unmarshallOptions = {
            // Whether to return numbers as a string instead of converting them to native JavaScript numbers.
            wrapNumbers: false, // false, by default.
        };
        const translateConfig = { marshallOptions, unmarshallOptions };
        this.documentClient = DynamoDBDocumentClient.from(dynamoDBClient, translateConfig);
    }
    async put(input) {
        return this.documentClient.send(new PutCommand(input));
    }
    async get(input) {
        return this.documentClient.send(new GetCommand(input));
    }
    async query(input) {
        return this.documentClient.send(new QueryCommand(input));
    }
    async update(input) {
        return this.documentClient.send(new UpdateCommand(input));
    }
    async delete(input) {
        return this.documentClient.send(new DeleteCommand(input));
    }
    async batchWrite(input) {
        return this.documentClient.send(new BatchWriteCommand(input));
    }
    async batchGet(input) {
        return this.documentClient.send(new BatchGetCommand(input));
    }
    async transactGet(input) {
        return this.documentClient.send(new TransactGetCommand(input));
    }
    async transactWrite(input) {
        try {
            const response = await this.documentClient.send(new TransactWriteCommand(input));
            return response;
        }
        catch (err) {
            if (err instanceof TransactionCanceledException) {
                // Remap TransactionCanceledException to unified TransactionCancelledException
                throw new TransactionCancelledException(err.Message || err.message, err.CancellationReasons?.map(reason => ({
                    code: reason.Code,
                    message: reason.Message,
                    item: reason.Item,
                })) || []);
            }
            throw err;
        }
    }
    async scan(input) {
        return this.documentClient.send(new ScanCommand(input));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZG9jdW1lbnQtY2xpZW50LXYzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvZG9jdW1lbnQtY2xpZW50L3NyYy9jbGFzc2VzL2RvY3VtZW50LWNsaWVudC12My50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBa0JMLDRCQUE0QixHQUs3QixNQUFNLDBCQUEwQixDQUFDO0FBQ2xDLE9BQU8sRUFDTCxlQUFlLEVBQ2YsaUJBQWlCLEVBQ2pCLGFBQWEsRUFDYixzQkFBc0IsRUFDdEIsVUFBVSxFQUNWLFVBQVUsRUFDVixZQUFZLEVBQ1osV0FBVyxFQUNYLGtCQUFrQixFQUNsQixvQkFBb0IsRUFDcEIsYUFBYSxHQUNkLE1BQU0sdUJBQXVCLENBQUM7QUFDL0IsT0FBTyxFQUFDLDZCQUE2QixFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQzVELE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSx3QkFBd0IsQ0FBQztBQUV0RCxNQUFNLE9BQU8sZ0JBRVgsU0FBUSxjQUFjO0lBQ2IsY0FBYyxDQUE2QjtJQUMzQyxPQUFPLEdBQUcsQ0FBQyxDQUFDO0lBRXJCLFlBQVksY0FBOEI7UUFDeEMsS0FBSyxFQUFFLENBQUM7UUFDUixNQUFNLGVBQWUsR0FBRztZQUN0Qiw2RUFBNkU7WUFDN0Usa0JBQWtCLEVBQUUsS0FBSztZQUN6Qix3REFBd0Q7WUFDeEQscUJBQXFCLEVBQUUsS0FBSztZQUM1QixxREFBcUQ7WUFDckQseUJBQXlCLEVBQUUsS0FBSyxFQUFFLHFCQUFxQjtTQUN4RCxDQUFDO1FBRUYsTUFBTSxpQkFBaUIsR0FBRztZQUN4QixpR0FBaUc7WUFDakcsV0FBVyxFQUFFLEtBQUssRUFBRSxxQkFBcUI7U0FDMUMsQ0FBQztRQUVGLE1BQU0sZUFBZSxHQUFHLEVBQUMsZUFBZSxFQUFFLGlCQUFpQixFQUFDLENBQUM7UUFDN0QsSUFBSSxDQUFDLGNBQWMsR0FBRyxzQkFBc0IsQ0FBQyxJQUFJLENBQy9DLGNBQWMsRUFDZCxlQUFlLENBQ2MsQ0FBQztJQUNsQyxDQUFDO0lBRUQsS0FBSyxDQUFDLEdBQUcsQ0FBQyxLQUFtQjtRQUMzQixPQUFPLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDekQsQ0FBQztJQUVELEtBQUssQ0FBQyxHQUFHLENBQUMsS0FBbUI7UUFDM0IsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQ3pELENBQUM7SUFFRCxLQUFLLENBQUMsS0FBSyxDQUFDLEtBQWlCO1FBQzNCLE9BQU8sSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztJQUMzRCxDQUFDO0lBRUQsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFzQjtRQUNqQyxPQUFPLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDNUQsQ0FBQztJQUVELEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBc0I7UUFDakMsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQzVELENBQUM7SUFFRCxLQUFLLENBQUMsVUFBVSxDQUFDLEtBQTBCO1FBQ3pDLE9BQU8sSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQ2hFLENBQUM7SUFFRCxLQUFLLENBQUMsUUFBUSxDQUFDLEtBQXdCO1FBQ3JDLE9BQU8sSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxlQUFlLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztJQUM5RCxDQUFDO0lBRUQsS0FBSyxDQUFDLFdBQVcsQ0FDZixLQUE0QjtRQUU1QixPQUFPLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksa0JBQWtCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztJQUNqRSxDQUFDO0lBRUQsS0FBSyxDQUFDLGFBQWEsQ0FDakIsS0FBOEI7UUFFOUIsSUFBSTtZQUNGLE1BQU0sUUFBUSxHQUFHLE1BQU0sSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQzdDLElBQUksb0JBQW9CLENBQUMsS0FBSyxDQUFDLENBQ2hDLENBQUM7WUFDRixPQUFPLFFBQVEsQ0FBQztTQUNqQjtRQUFDLE9BQU8sR0FBRyxFQUFFO1lBQ1osSUFBSSxHQUFHLFlBQVksNEJBQTRCLEVBQUU7Z0JBQy9DLDhFQUE4RTtnQkFDOUUsTUFBTSxJQUFJLDZCQUE2QixDQUNyQyxHQUFHLENBQUMsT0FBTyxJQUFJLEdBQUcsQ0FBQyxPQUFPLEVBQzFCLEdBQUcsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDO29CQUN0QyxJQUFJLEVBQUUsTUFBTSxDQUFDLElBQUk7b0JBQ2pCLE9BQU8sRUFBRSxNQUFNLENBQUMsT0FBTztvQkFDdkIsSUFBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJO2lCQUNsQixDQUFDLENBQUMsSUFBSSxFQUFFLENBQ1YsQ0FBQzthQUNIO1lBQ0QsTUFBTSxHQUFHLENBQUM7U0FDWDtJQUNILENBQUM7SUFFRCxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQWdCO1FBQ3pCLE9BQU8sSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztJQUMxRCxDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBCYXRjaEdldEl0ZW1JbnB1dCxcbiAgQmF0Y2hHZXRJdGVtT3V0cHV0LFxuICBCYXRjaFdyaXRlSXRlbUlucHV0LFxuICBCYXRjaFdyaXRlSXRlbU91dHB1dCxcbiAgRGVsZXRlSXRlbUlucHV0LFxuICBEZWxldGVJdGVtT3V0cHV0LFxuICBEeW5hbW9EQkNsaWVudCxcbiAgR2V0SXRlbUlucHV0LFxuICBHZXRJdGVtT3V0cHV0LFxuICBQdXRJdGVtSW5wdXQsXG4gIFB1dEl0ZW1PdXRwdXQsXG4gIFF1ZXJ5SW5wdXQsXG4gIFF1ZXJ5T3V0cHV0LFxuICBTY2FuSW5wdXQsXG4gIFNjYW5PdXRwdXQsXG4gIFRyYW5zYWN0R2V0SXRlbXNJbnB1dCxcbiAgVHJhbnNhY3RHZXRJdGVtc091dHB1dCxcbiAgVHJhbnNhY3Rpb25DYW5jZWxlZEV4Y2VwdGlvbixcbiAgVHJhbnNhY3RXcml0ZUl0ZW1zSW5wdXQsXG4gIFRyYW5zYWN0V3JpdGVJdGVtc091dHB1dCxcbiAgVXBkYXRlSXRlbUlucHV0LFxuICBVcGRhdGVJdGVtT3V0cHV0LFxufSBmcm9tICdAYXdzLXNkay9jbGllbnQtZHluYW1vZGInO1xuaW1wb3J0IHtcbiAgQmF0Y2hHZXRDb21tYW5kLFxuICBCYXRjaFdyaXRlQ29tbWFuZCxcbiAgRGVsZXRlQ29tbWFuZCxcbiAgRHluYW1vREJEb2N1bWVudENsaWVudCxcbiAgR2V0Q29tbWFuZCxcbiAgUHV0Q29tbWFuZCxcbiAgUXVlcnlDb21tYW5kLFxuICBTY2FuQ29tbWFuZCxcbiAgVHJhbnNhY3RHZXRDb21tYW5kLFxuICBUcmFuc2FjdFdyaXRlQ29tbWFuZCxcbiAgVXBkYXRlQ29tbWFuZCxcbn0gZnJvbSAnQGF3cy1zZGsvbGliLWR5bmFtb2RiJztcbmltcG9ydCB7VHJhbnNhY3Rpb25DYW5jZWxsZWRFeGNlcHRpb259IGZyb20gJy4uL2V4Y2VwdGlvbnMnO1xuaW1wb3J0IHtEb2N1bWVudENsaWVudH0gZnJvbSAnLi9iYXNlLWRvY3VtZW50LWNsaWVudCc7XG5cbmV4cG9ydCBjbGFzcyBEb2N1bWVudENsaWVudFYzPFxuICBEeW5hbW9EQkRvY3VtZW50Q2xpZW50VHlwZSBleHRlbmRzIER5bmFtb0RCRG9jdW1lbnRDbGllbnQgPSBEeW5hbW9EQkRvY3VtZW50Q2xpZW50XG4+IGV4dGVuZHMgRG9jdW1lbnRDbGllbnQge1xuICByZWFkb25seSBkb2N1bWVudENsaWVudDogRHluYW1vREJEb2N1bWVudENsaWVudFR5cGU7XG4gIHJlYWRvbmx5IHZlcnNpb24gPSAzO1xuXG4gIGNvbnN0cnVjdG9yKGR5bmFtb0RCQ2xpZW50OiBEeW5hbW9EQkNsaWVudCkge1xuICAgIHN1cGVyKCk7XG4gICAgY29uc3QgbWFyc2hhbGxPcHRpb25zID0ge1xuICAgICAgLy8gV2hldGhlciB0byBhdXRvbWF0aWNhbGx5IGNvbnZlcnQgZW1wdHkgc3RyaW5ncywgYmxvYnMsIGFuZCBzZXRzIHRvIGBudWxsYC5cbiAgICAgIGNvbnZlcnRFbXB0eVZhbHVlczogZmFsc2UsIC8vIGZhbHNlLCBieSBkZWZhdWx0LlxuICAgICAgLy8gV2hldGhlciB0byByZW1vdmUgdW5kZWZpbmVkIHZhbHVlcyB3aGlsZSBtYXJzaGFsbGluZy5cbiAgICAgIHJlbW92ZVVuZGVmaW5lZFZhbHVlczogZmFsc2UsIC8vIGZhbHNlLCBieSBkZWZhdWx0LlxuICAgICAgLy8gV2hldGhlciB0byBjb252ZXJ0IHR5cGVvZiBvYmplY3QgdG8gbWFwIGF0dHJpYnV0ZS5cbiAgICAgIGNvbnZlcnRDbGFzc0luc3RhbmNlVG9NYXA6IGZhbHNlLCAvLyBmYWxzZSwgYnkgZGVmYXVsdC5cbiAgICB9O1xuXG4gICAgY29uc3QgdW5tYXJzaGFsbE9wdGlvbnMgPSB7XG4gICAgICAvLyBXaGV0aGVyIHRvIHJldHVybiBudW1iZXJzIGFzIGEgc3RyaW5nIGluc3RlYWQgb2YgY29udmVydGluZyB0aGVtIHRvIG5hdGl2ZSBKYXZhU2NyaXB0IG51bWJlcnMuXG4gICAgICB3cmFwTnVtYmVyczogZmFsc2UsIC8vIGZhbHNlLCBieSBkZWZhdWx0LlxuICAgIH07XG5cbiAgICBjb25zdCB0cmFuc2xhdGVDb25maWcgPSB7bWFyc2hhbGxPcHRpb25zLCB1bm1hcnNoYWxsT3B0aW9uc307XG4gICAgdGhpcy5kb2N1bWVudENsaWVudCA9IER5bmFtb0RCRG9jdW1lbnRDbGllbnQuZnJvbShcbiAgICAgIGR5bmFtb0RCQ2xpZW50LFxuICAgICAgdHJhbnNsYXRlQ29uZmlnXG4gICAgKSBhcyBEeW5hbW9EQkRvY3VtZW50Q2xpZW50VHlwZTtcbiAgfVxuXG4gIGFzeW5jIHB1dChpbnB1dDogUHV0SXRlbUlucHV0KTogUHJvbWlzZTxQdXRJdGVtT3V0cHV0PiB7XG4gICAgcmV0dXJuIHRoaXMuZG9jdW1lbnRDbGllbnQuc2VuZChuZXcgUHV0Q29tbWFuZChpbnB1dCkpO1xuICB9XG5cbiAgYXN5bmMgZ2V0KGlucHV0OiBHZXRJdGVtSW5wdXQpOiBQcm9taXNlPEdldEl0ZW1PdXRwdXQ+IHtcbiAgICByZXR1cm4gdGhpcy5kb2N1bWVudENsaWVudC5zZW5kKG5ldyBHZXRDb21tYW5kKGlucHV0KSk7XG4gIH1cblxuICBhc3luYyBxdWVyeShpbnB1dDogUXVlcnlJbnB1dCk6IFByb21pc2U8UXVlcnlPdXRwdXQ+IHtcbiAgICByZXR1cm4gdGhpcy5kb2N1bWVudENsaWVudC5zZW5kKG5ldyBRdWVyeUNvbW1hbmQoaW5wdXQpKTtcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZShpbnB1dDogVXBkYXRlSXRlbUlucHV0KTogUHJvbWlzZTxVcGRhdGVJdGVtT3V0cHV0PiB7XG4gICAgcmV0dXJuIHRoaXMuZG9jdW1lbnRDbGllbnQuc2VuZChuZXcgVXBkYXRlQ29tbWFuZChpbnB1dCkpO1xuICB9XG5cbiAgYXN5bmMgZGVsZXRlKGlucHV0OiBEZWxldGVJdGVtSW5wdXQpOiBQcm9taXNlPERlbGV0ZUl0ZW1PdXRwdXQ+IHtcbiAgICByZXR1cm4gdGhpcy5kb2N1bWVudENsaWVudC5zZW5kKG5ldyBEZWxldGVDb21tYW5kKGlucHV0KSk7XG4gIH1cblxuICBhc3luYyBiYXRjaFdyaXRlKGlucHV0OiBCYXRjaFdyaXRlSXRlbUlucHV0KTogUHJvbWlzZTxCYXRjaFdyaXRlSXRlbU91dHB1dD4ge1xuICAgIHJldHVybiB0aGlzLmRvY3VtZW50Q2xpZW50LnNlbmQobmV3IEJhdGNoV3JpdGVDb21tYW5kKGlucHV0KSk7XG4gIH1cblxuICBhc3luYyBiYXRjaEdldChpbnB1dDogQmF0Y2hHZXRJdGVtSW5wdXQpOiBQcm9taXNlPEJhdGNoR2V0SXRlbU91dHB1dD4ge1xuICAgIHJldHVybiB0aGlzLmRvY3VtZW50Q2xpZW50LnNlbmQobmV3IEJhdGNoR2V0Q29tbWFuZChpbnB1dCkpO1xuICB9XG5cbiAgYXN5bmMgdHJhbnNhY3RHZXQoXG4gICAgaW5wdXQ6IFRyYW5zYWN0R2V0SXRlbXNJbnB1dFxuICApOiBQcm9taXNlPFRyYW5zYWN0R2V0SXRlbXNPdXRwdXQ+IHtcbiAgICByZXR1cm4gdGhpcy5kb2N1bWVudENsaWVudC5zZW5kKG5ldyBUcmFuc2FjdEdldENvbW1hbmQoaW5wdXQpKTtcbiAgfVxuXG4gIGFzeW5jIHRyYW5zYWN0V3JpdGUoXG4gICAgaW5wdXQ6IFRyYW5zYWN0V3JpdGVJdGVtc0lucHV0XG4gICk6IFByb21pc2U8VHJhbnNhY3RXcml0ZUl0ZW1zT3V0cHV0PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5kb2N1bWVudENsaWVudC5zZW5kKFxuICAgICAgICBuZXcgVHJhbnNhY3RXcml0ZUNvbW1hbmQoaW5wdXQpXG4gICAgICApO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIFRyYW5zYWN0aW9uQ2FuY2VsZWRFeGNlcHRpb24pIHtcbiAgICAgICAgLy8gUmVtYXAgVHJhbnNhY3Rpb25DYW5jZWxlZEV4Y2VwdGlvbiB0byB1bmlmaWVkIFRyYW5zYWN0aW9uQ2FuY2VsbGVkRXhjZXB0aW9uXG4gICAgICAgIHRocm93IG5ldyBUcmFuc2FjdGlvbkNhbmNlbGxlZEV4Y2VwdGlvbihcbiAgICAgICAgICBlcnIuTWVzc2FnZSB8fCBlcnIubWVzc2FnZSxcbiAgICAgICAgICBlcnIuQ2FuY2VsbGF0aW9uUmVhc29ucz8ubWFwKHJlYXNvbiA9PiAoe1xuICAgICAgICAgICAgY29kZTogcmVhc29uLkNvZGUsXG4gICAgICAgICAgICBtZXNzYWdlOiByZWFzb24uTWVzc2FnZSxcbiAgICAgICAgICAgIGl0ZW06IHJlYXNvbi5JdGVtLFxuICAgICAgICAgIH0pKSB8fCBbXVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHNjYW4oaW5wdXQ6IFNjYW5JbnB1dCk6IFByb21pc2U8U2Nhbk91dHB1dD4ge1xuICAgIHJldHVybiB0aGlzLmRvY3VtZW50Q2xpZW50LnNlbmQobmV3IFNjYW5Db21tYW5kKGlucHV0KSk7XG4gIH1cbn1cbiJdfQ==