"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Attribute = void 0;
require("reflect-metadata");
const metadata_manager_1 = require("../metadata/metadata-manager");
const error_1 = require("../error");
function Attribute(options) {
    return (target, propertyKey) => {
        const reflectedMetadata = Reflect.getMetadata('design:type', target, propertyKey);
        if (!reflectedMetadata) {
            throw new error_1.MissingReflectMetadataError('design:type');
        }
        let type = reflectedMetadata.name;
        if (options === null || options === void 0 ? void 0 : options.isEnum) {
            // default to "String" when attribute is marked as enum
            type = 'String';
        }
        const attributeProps = {
            name: propertyKey.toString(),
            type,
            unique: options === null || options === void 0 ? void 0 : options.unique,
            default: options === null || options === void 0 ? void 0 : options.default,
            hidden: options === null || options === void 0 ? void 0 : options.hidden,
        };
        metadata_manager_1.MetadataManager.metadataStorage.addRawAttribute(target.constructor, attributeProps);
    };
}
exports.Attribute = Attribute;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXR0cmlidXRlLmRlY29yYXRvci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL2NvbW1vbi9zcmMvZGVjb3JhdG9ycy9hdHRyaWJ1dGUuZGVjb3JhdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLDRCQUEwQjtBQUUxQixtRUFBNkQ7QUFLN0Qsb0NBQXFEO0FBK0JyRCxTQUFnQixTQUFTLENBQ3ZCLE9BQWtDO0lBRWxDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsV0FBVyxFQUFRLEVBQUU7UUFDbkMsTUFBTSxpQkFBaUIsR0FBRyxPQUFPLENBQUMsV0FBVyxDQUMzQyxhQUFhLEVBQ2IsTUFBTSxFQUNOLFdBQVcsQ0FDWixDQUFDO1FBRUYsSUFBSSxDQUFDLGlCQUFpQixFQUFFO1lBQ3RCLE1BQU0sSUFBSSxtQ0FBMkIsQ0FBQyxhQUFhLENBQUMsQ0FBQztTQUN0RDtRQUVELElBQUksSUFBSSxHQUFHLGlCQUFpQixDQUFDLElBQUksQ0FBQztRQUVsQyxJQUFJLE9BQU8sYUFBUCxPQUFPLHVCQUFQLE9BQU8sQ0FBRSxNQUFNLEVBQUU7WUFDbkIsdURBQXVEO1lBQ3ZELElBQUksR0FBRyxRQUFRLENBQUM7U0FDakI7UUFFRCxNQUFNLGNBQWMsR0FBRztZQUNyQixJQUFJLEVBQUUsV0FBVyxDQUFDLFFBQVEsRUFBRTtZQUM1QixJQUFJO1lBQ0osTUFBTSxFQUFFLE9BQU8sYUFBUCxPQUFPLHVCQUFQLE9BQU8sQ0FBRSxNQUFNO1lBQ3ZCLE9BQU8sRUFBRSxPQUFPLGFBQVAsT0FBTyx1QkFBUCxPQUFPLENBQUUsT0FBTztZQUN6QixNQUFNLEVBQUUsT0FBTyxhQUFQLE9BQU8sdUJBQVAsT0FBTyxDQUFFLE1BQU07U0FDTyxDQUFDO1FBRWpDLGtDQUFlLENBQUMsZUFBZSxDQUFDLGVBQWUsQ0FDN0MsTUFBTSxDQUFDLFdBQVcsRUFDbEIsY0FBYyxDQUNmLENBQUM7SUFDSixDQUFDLENBQUM7QUFDSixDQUFDO0FBbENELDhCQWtDQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAncmVmbGVjdC1tZXRhZGF0YSc7XG5pbXBvcnQge1NjYWxhclR5cGV9IGZyb20gJy4uL2hlbHBlcnMvc2NhbGFyLXR5cGUnO1xuaW1wb3J0IHtNZXRhZGF0YU1hbmFnZXJ9IGZyb20gJy4uL21ldGFkYXRhL21ldGFkYXRhLW1hbmFnZXInO1xuaW1wb3J0IHtcbiAgQXR0cmlidXRlUmF3TWV0YWRhdGFPcHRpb25zLFxuICBQcmltYXJ5S2V5LFxufSBmcm9tICcuLi9tZXRhZGF0YS9tZXRhZGF0YS1zdG9yYWdlJztcbmltcG9ydCB7TWlzc2luZ1JlZmxlY3RNZXRhZGF0YUVycm9yfSBmcm9tICcuLi9lcnJvcic7XG5cbmV4cG9ydCB0eXBlIEF0dHJpYnV0ZU9wdGlvbnNVbmlxdWVUeXBlPEVudGl0eSA9IGFueT4gPVxuICB8IGJvb2xlYW5cbiAgfCBQcmltYXJ5S2V5PEVudGl0eT47XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXR0cmlidXRlT3B0aW9uczxFbnRpdHk+IHtcbiAgLyoqXG4gICAqIEl0ZW0gd2lsbCBiZSBtYW5hZ2VkIHVzaW5nIHRyYW5zYWN0aW9uIHRvIGVuc3VyZSBpdCdzIGNvbnNpc3RlbmN5XG4gICAqIFdoZW4gdmFsdWUgb2YgdW5pcXVlIGlzIG9mIHR5cGUgYm9vbGVhbiwgZW50aXR5IG5hbWUgaXMgdXNlZCB0byBhdXRvIGdlbmVyYXRlZCB1bmlxdWUgcHJlZml4XG4gICAqIEBkZWZhdWx0IGZhbHNlXG4gICAqXG4gICAqL1xuICB1bmlxdWU/OiBBdHRyaWJ1dGVPcHRpb25zVW5pcXVlVHlwZTxFbnRpdHk+O1xuICAvKipcbiAgICogTWFyayBwcm9wZXJ0eSBhcyBlbnVtXG4gICAqIEByZXF1aXJlZCB3aGVuIHByb3BlcnR5IG9mIHR5cGUgZW51bSBpcyByZWZlcmVuY2VkIGluIGtleVxuICAgKiBAZGVmYXVsdCBmYWxzZVxuICAgKi9cbiAgaXNFbnVtPzogYm9vbGVhbjtcbiAgLyoqXG4gICAqIEFzc2lnbiBkZWZhdWx0IHZhbHVlIHRvIGF0dHJpYnV0ZVxuICAgKi9cbiAgZGVmYXVsdD86IFNjYWxhclR5cGUgfCAoKGVudGl0eTogRW50aXR5KSA9PiBTY2FsYXJUeXBlKTtcbiAgLyoqXG4gICAqIERlZmluZXMgd2hldGhlciB0aGUgYXR0cmlidXRlIHNob3VsZCBiZSBoaWRkZW4gZnJvbSByZXNwb25zZSByZXR1cm5lZCB0byBjbGllbnRcbiAgICogQGRlZmF1bHQgZmFsc2VcbiAgICovXG4gIGhpZGRlbj86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBBdHRyaWJ1dGU8RW50aXR5ID0gYW55PihcbiAgb3B0aW9ucz86IEF0dHJpYnV0ZU9wdGlvbnM8RW50aXR5PlxuKTogUHJvcGVydHlEZWNvcmF0b3Ige1xuICByZXR1cm4gKHRhcmdldCwgcHJvcGVydHlLZXkpOiB2b2lkID0+IHtcbiAgICBjb25zdCByZWZsZWN0ZWRNZXRhZGF0YSA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoXG4gICAgICAnZGVzaWduOnR5cGUnLFxuICAgICAgdGFyZ2V0LFxuICAgICAgcHJvcGVydHlLZXlcbiAgICApO1xuXG4gICAgaWYgKCFyZWZsZWN0ZWRNZXRhZGF0YSkge1xuICAgICAgdGhyb3cgbmV3IE1pc3NpbmdSZWZsZWN0TWV0YWRhdGFFcnJvcignZGVzaWduOnR5cGUnKTtcbiAgICB9XG5cbiAgICBsZXQgdHlwZSA9IHJlZmxlY3RlZE1ldGFkYXRhLm5hbWU7XG5cbiAgICBpZiAob3B0aW9ucz8uaXNFbnVtKSB7XG4gICAgICAvLyBkZWZhdWx0IHRvIFwiU3RyaW5nXCIgd2hlbiBhdHRyaWJ1dGUgaXMgbWFya2VkIGFzIGVudW1cbiAgICAgIHR5cGUgPSAnU3RyaW5nJztcbiAgICB9XG5cbiAgICBjb25zdCBhdHRyaWJ1dGVQcm9wcyA9IHtcbiAgICAgIG5hbWU6IHByb3BlcnR5S2V5LnRvU3RyaW5nKCksXG4gICAgICB0eXBlLFxuICAgICAgdW5pcXVlOiBvcHRpb25zPy51bmlxdWUsXG4gICAgICBkZWZhdWx0OiBvcHRpb25zPy5kZWZhdWx0LFxuICAgICAgaGlkZGVuOiBvcHRpb25zPy5oaWRkZW4sXG4gICAgfSBhcyBBdHRyaWJ1dGVSYXdNZXRhZGF0YU9wdGlvbnM7XG5cbiAgICBNZXRhZGF0YU1hbmFnZXIubWV0YWRhdGFTdG9yYWdlLmFkZFJhd0F0dHJpYnV0ZShcbiAgICAgIHRhcmdldC5jb25zdHJ1Y3RvcixcbiAgICAgIGF0dHJpYnV0ZVByb3BzXG4gICAgKTtcbiAgfTtcbn1cbiJdfQ==