"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getHashedIdForInput = void 0;
const uuid_1 = require("uuid");
const deep_sort_object_1 = require("./deep-sort-object");
/**
 * Generates unique id from SHA1 hashed data and given namespaceId
 * @param namespaceId unique namespace id to generate scoped id
 * @param dataToHash object to hash
 * @returns string
 *
 */
function getHashedIdForInput(namespaceId, dataToHash) {
    if (!(0, uuid_1.validate)(namespaceId)) {
        throw new Error('Workspace id must be an uuid');
    }
    // since JSON.stringify doesn't guarantee order, we first sort them before creating hash of it
    const sortedObj = (0, deep_sort_object_1.deepSortObject)(dataToHash);
    const stringifiedData = JSON.stringify(sortedObj);
    return (0, uuid_1.v5)(stringifiedData, namespaceId);
}
exports.getHashedIdForInput = getHashedIdForInput;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0LWhhc2hlZC1pZC1mb3ItaW5wdXQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9jb3JlL3NyYy9oZWxwZXJzL2dldC1oYXNoZWQtaWQtZm9yLWlucHV0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLCtCQUFrQztBQUNsQyx5REFBa0Q7QUFFbEQ7Ozs7OztHQU1HO0FBQ0gsU0FBZ0IsbUJBQW1CLENBQ2pDLFdBQW1CLEVBQ25CLFVBQWE7SUFFYixJQUFJLENBQUMsSUFBQSxlQUFRLEVBQUMsV0FBVyxDQUFDLEVBQUU7UUFDMUIsTUFBTSxJQUFJLEtBQUssQ0FBQyw4QkFBOEIsQ0FBQyxDQUFDO0tBQ2pEO0lBRUQsOEZBQThGO0lBQzlGLE1BQU0sU0FBUyxHQUFHLElBQUEsaUNBQWMsRUFBQyxVQUFVLENBQUMsQ0FBQztJQUU3QyxNQUFNLGVBQWUsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ2xELE9BQU8sSUFBQSxTQUFFLEVBQUMsZUFBZSxFQUFFLFdBQVcsQ0FBQyxDQUFDO0FBQzFDLENBQUM7QUFiRCxrREFhQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7dmFsaWRhdGUsIHY1fSBmcm9tICd1dWlkJztcbmltcG9ydCB7ZGVlcFNvcnRPYmplY3R9IGZyb20gJy4vZGVlcC1zb3J0LW9iamVjdCc7XG5cbi8qKlxuICogR2VuZXJhdGVzIHVuaXF1ZSBpZCBmcm9tIFNIQTEgaGFzaGVkIGRhdGEgYW5kIGdpdmVuIG5hbWVzcGFjZUlkXG4gKiBAcGFyYW0gbmFtZXNwYWNlSWQgdW5pcXVlIG5hbWVzcGFjZSBpZCB0byBnZW5lcmF0ZSBzY29wZWQgaWRcbiAqIEBwYXJhbSBkYXRhVG9IYXNoIG9iamVjdCB0byBoYXNoXG4gKiBAcmV0dXJucyBzdHJpbmdcbiAqXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRIYXNoZWRJZEZvcklucHV0PFQgZXh0ZW5kcyBvYmplY3Q+KFxuICBuYW1lc3BhY2VJZDogc3RyaW5nLFxuICBkYXRhVG9IYXNoOiBUXG4pIHtcbiAgaWYgKCF2YWxpZGF0ZShuYW1lc3BhY2VJZCkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1dvcmtzcGFjZSBpZCBtdXN0IGJlIGFuIHV1aWQnKTtcbiAgfVxuXG4gIC8vIHNpbmNlIEpTT04uc3RyaW5naWZ5IGRvZXNuJ3QgZ3VhcmFudGVlIG9yZGVyLCB3ZSBmaXJzdCBzb3J0IHRoZW0gYmVmb3JlIGNyZWF0aW5nIGhhc2ggb2YgaXRcbiAgY29uc3Qgc29ydGVkT2JqID0gZGVlcFNvcnRPYmplY3QoZGF0YVRvSGFzaCk7XG5cbiAgY29uc3Qgc3RyaW5naWZpZWREYXRhID0gSlNPTi5zdHJpbmdpZnkoc29ydGVkT2JqKTtcbiAgcmV0dXJuIHY1KHN0cmluZ2lmaWVkRGF0YSwgbmFtZXNwYWNlSWQpO1xufVxuIl19